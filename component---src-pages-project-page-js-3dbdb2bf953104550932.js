"use strict";(self.webpackChunkmyjscourse=self.webpackChunkmyjscourse||[]).push([[355],{9802:function(e,t,r){var n=r(7294),a=r(6267),c=r.n(a);t.Z=function(e){var t,r,a=e.className,o=e.isBeingEdited,s=e.onChange,i=e.startContent,u=e.id,d=e.isInline,l=e.children;return o?t=c().decode(i):l?t=l:i&&(t=c().decode(i)),r=a||"",o&&(r+=" index__card__content__description--is-being-edited"),d&&(r+=" index__card__content__description--is-inline"),n.createElement("div",{className:r,contentEditable:!!o,onInput:function(e){var t={};t[u]=e.currentTarget.textContent,s(t)},suppressContentEditableWarning:!0},t)}},3290:function(e,t,r){r.d(t,{X:function(){return m},a:function(){return f}});var n=r(4942),a=r(5861),c=r(7757),o=r.n(c),s=r(7294),i=r(693),u=r(5735),d=r(144);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var p=s.createContext([{},function(){},{},function(){},{},function(){},{},function(){}]),f=function(e){var t=e.children,r=(0,s.useState)(void 0),n=r[0],a=r[1],c=(0,s.useState)(void 0),o=c[0],i=c[1],u=(0,s.useState)(void 0),d=u[0],l=u[1],f=(0,s.useState)(!1),m=f[0],_=f[1];return s.createElement(p.Provider,{value:[n,a,o,i,d,l,m,_]},t)},m=function(){var e=(0,u.Fp)(),t=e.instance,r=e.accounts,c=(0,s.useContext)(p),f=c[0],m=c[1],_=c[2],v=c[3],x=c[4],h=c[5],j=c[6],b=c[7],E=function(){var e=(0,a.Z)(o().mark((function e(n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.t)(r,t);case 3:return a=e.sent,e.next=6,(0,i.Z)("projectgroups/"+n,"get",a,void 0);case 6:return c=e.sent,m(c),console.log("STATE NOW ????",f),e.abrupt("return",c);case 12:e.prev=12,e.t0=e.catch(0),console.error("useProjectData:error:",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,a.Z)(o().mark((function e(){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.t)(r,t);case 3:return n=e.sent,e.next=6,(0,i.Z)("users/role","get",n,void 0);case 6:return a=e.sent,v(a),e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(0),console.error("useProjectData:updateUserData:error:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,a.Z)(o().mark((function e(n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.t)(r,t);case 3:return a=e.sent,b(!1),e.next=7,(0,i.Z)("projects/projectgroups/"+n,"get",a,void 0);case 7:return c=e.sent,h(c),console.log("project array updated",c),b(!0),e.abrupt("return",c);case 14:e.prev=14,e.t0=e.catch(0),console.error("useProjectData:updateProjectDataerror:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,a.Z)(o().mark((function e(n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.t)(r,t);case 3:return a=e.sent,e.next=6,(0,i.Z)("projects","post",a,void 0);case 6:return c=e.sent,e.abrupt("return",c);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:addOneProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,a.Z)(o().mark((function e(n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.t)(r,t);case 3:return a=e.sent,e.next=6,(0,i.Z)("projects/"+n._id,"DELETE",a,void 0);case 6:return c=e.sent,e.abrupt("return",c);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:deleteOneProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,a.Z)(o().mark((function e(n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.t)(r,t);case 3:return a=e.sent,e.next=6,(0,i.Z)("projects/"+n._id+"/member","POST",a,void 0);case 6:return c=e.sent,e.abrupt("return",c);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:addMemberToProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,a.Z)(o().mark((function e(n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.t)(r,t);case 3:return a=e.sent,e.next=6,(0,i.Z)("projects/"+n._id+"/member","DELETE",a,void 0);case 6:return c=e.sent,e.abrupt("return",c);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:deleteMemberFromProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,a.Z)(o().mark((function e(n,a){var c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("project to be updated:",n),e.prev=1,e.next=4,(0,d.t)(r,t);case 4:return c=e.sent,e.next=7,(0,i.Z)("projects/"+a,"PATCH",c,n);case 7:return s=e.sent,console.log("project updated:",s),e.abrupt("return",s);case 12:e.prev=12,e.t0=e.catch(1),console.error("useProjectData:updateProject:error:",e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,r){return e.apply(this,arguments)}}();return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},{projectGroupData:f,updateProjectGroupData:E,userData:_,updateUserData:g,projectData:x,updateProjectData:P,addOneProject:w,deleteOneProject:k,addMemberToProject:y,deleteMemberFromProject:O,updateProject:C,isLoaded:j,setIsLoaded:b})}},9896:function(e,t,r){var n=r(7294),a=r(3364),c=r(5514);t.Z=function(){return n.createElement("div",{className:"spinner"},n.createElement("div",{className:"spinner__overlay"}),n.createElement("div",{className:"spinner__animation"},n.createElement(a.G,{icon:c.LM3,className:"fa-3x fa-spin"})))}},8329:function(e,t,r){r.r(t),r.d(t,{default:function(){return P}});var n=r(7294),a=r(1597),c=r(9147),o=r(1066),s=r(3290),i=r(5861),u=r(7757),d=r.n(u),l=r(9256),p=r(4942),f=(r(6267),r(3364)),m=r(5514),_=r(3405),v=r(9802);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,p.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=function(e){var t=e.project,r=e.setFilteredContents,a=(0,n.useState)(!1),c=a[0],o=a[1],u=(0,n.useState)(t.isPublic),p=u[0],x=u[1],j=(0,n.useState)({}),b=j[0],E=j[1],g=(0,s.X)(),P=g.deleteOneProject,w=g.updateProjectData,k=g.addMemberToProject,y=g.deleteMemberFromProject,O=g.updateProject,C=g.userData,N=g.projectGroupData,D=g.projectData,Z=function(){var e=(0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:return e.next=4,w(t.projectGroupName);case 4:r(void 0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,i.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t);case 2:if(n=e.sent,console.log("onAddMemberToProject:",n),!w){e.next=8;break}return e.next=7,w(t.projectGroupName);case 7:r(void 0);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,i.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:if(n=e.sent,console.log("onDeleteMemberFromProject:",n),!w){e.next=8;break}return e.next=7,w(t.projectGroupName);case 7:r(void 0);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,i.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=10;break}return e.next=3,O(b,t._id);case 3:if(n=e.sent,E({}),o(!1),!n){e.next=10;break}return e.next=9,w(t.projectGroupName);case 9:r(void 0);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(e){E((function(t){return h(h({},t),e)}))};return console.log("projStateUpdated:",b),t?n.createElement("div",{className:"index__card"+(c?" index__card--is-being-edited":""),key:t.shortId,id:t.shortId},n.createElement("div",{className:"index__card__header"},n.createElement("span",null,"Projet N° "+t.shortId+" : "),n.createElement(v.Z,{isBeingEdited:c,id:"name",onChange:G,startContent:t.name,isInline:!0})),n.createElement("div",{className:"index__card__description"},C.isAdmin&&n.createElement(f.G,{icon:m.I7k,onClick:Z}),(C.isAdmin||t.projectMembers.includes(C.userName)&&"end"!==N.status)&&!c?n.createElement(f.G,{icon:m.Xcf,onClick:function(){o(!0)}}):"","init"===N.status&&!D.find((function(e){return e.projectMembers.includes(C.userName)}))&&t.projectMembers.length<N.maximumProjectMembers&&n.createElement(f.G,{icon:m.FKd,onClick:S}),"init"===N.status&&t.projectMembers.includes(C.userName)&&n.createElement(f.G,{icon:m.iC0,onClick:F}),c&&n.createElement(f.G,{icon:m.r6l,onClick:M}),c&&n.createElement(f.G,{icon:m.NBC,onClick:function(){o(!1),E({})}})),n.createElement("div",{className:"index__card__content"},void 0!==t.description?n.createElement(n.Fragment,null,n.createElement("div",{className:"index__card__content__title"},"Description"),n.createElement(v.Z,{className:"index__card__content__description",isBeingEdited:c,id:"description",startContent:t.description,onChange:G})):""),n.createElement("div",{className:"index__card__content"},void 0!==t.presentationUrl?n.createElement(n.Fragment,null,n.createElement("div",{className:"index__card__content__title"},"Vidéo de présentation"),n.createElement(v.Z,{className:"index__card__content__description",isBeingEdited:c,id:"presentationUrl",startContent:t.presentationUrl,onChange:G},n.createElement(l.Z,{src:t.presentationUrl}))):""),n.createElement("div",{className:"index__card__content"},void 0!==t.frontendProductionUrl?n.createElement(n.Fragment,null,n.createElement("div",{className:"index__card__content__title"},"URL du site"),n.createElement(v.Z,{className:"index__card__content__description",isBeingEdited:c,id:"frontendProductionUrl",startContent:t.frontendProductionUrl,onChange:G},n.createElement("a",{href:t.frontendProductionUrl,target:"_blank"},t.frontendProductionUrl))):""),n.createElement("div",{className:"index__card__content"},void 0!==t.frontendRepo?n.createElement(n.Fragment,null,n.createElement("div",{className:"index__card__content__title"},"Repo frontend"),n.createElement(v.Z,{className:"index__card__content__description",isBeingEdited:c,id:"frontendRepo",startContent:t.frontendRepo,onChange:G},n.createElement("a",{href:t.frontendRepo,target:"_blank"},t.frontendRepo))):""),n.createElement("div",{className:"index__card__content"},void 0!==t.backendRepo?n.createElement(n.Fragment,null,n.createElement("div",{className:"index__card__content__title"},"Repo backend"),n.createElement(v.Z,{className:"index__card__content__description",isBeingEdited:c,id:"backendRepo",startContent:t.backendRepo,onChange:G},n.createElement("a",{href:t.backendRepo,target:"_blank"},t.backendRepo))):""),n.createElement("div",{className:"index__card__content"},void 0!==t.projectMembers&&t.projectMembers.length>0?n.createElement(n.Fragment,null,n.createElement("div",{className:"index__card__content__title"},"Membres du projet"),n.createElement("div",{className:"index__card__content__description"},t.projectMembers.map((function(e){return(0,_.w)(e)})).join(", "))):""),n.createElement("div",{className:"index__card__content"},void 0!==t.isPublic?n.createElement(n.Fragment,null,n.createElement("div",{className:"index__card__content__title"},"Public ?"),n.createElement("div",{className:"index__card__content__description"},n.createElement("input",{type:"checkbox",checked:p,disabled:!c,onClick:function(e){x(!p),E(h(h({},b),{isPublic:!p}))}}))):"")):null},b=function(e){var t=e.projects,r=e.setFilteredContents;return console.log("PROJECTSVIEW",t),!t||t.length<=0?null:n.createElement(n.Fragment,null,t.map((function(e){return n.createElement(j,{project:e,setFilteredContents:r})})))},E=r(9896),g=function(e){var t=e.associatedProjectGroupName,r=(0,s.X)(),a=r.projectGroupData,c=r.updateProjectGroupData,o=r.userData,u=r.updateUserData,l=r.isLoaded,p=r.projectData,f=r.addOneProject,m=r.updateProjectData,_=(0,n.useState)(void 0),v=_[0],x=_[1],h=(0,n.useState)(""),j=(h[0],h[1]),g=function(){var e=(0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("add and",a._id),e.next=3,f();case 3:return e.next=5,m(a._id);case 5:e.sent,x(void 0);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,n.useEffect)((function(){P()}),[]);var P=function(){var e=(0,i.Z)(d().mark((function e(){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(t);case 3:return r=e.sent,e.next=6,u();case 6:return e.sent,e.next=9,m(r._id);case 9:e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("getData:error",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return n.createElement(n.Fragment,null,!l&&n.createElement(E.Z,null),void 0===a?"":n.createElement("div",{className:"pl-3 pt-3 pb-3 pr-3"},n.createElement("h3",{className:""},"Projets des groupes de ",a._id),n.createElement("div",{className:"index"},n.createElement("input",{type:"text","aria-label":"Search",placeholder:"Filtrez les contenus...",onChange:function(e){var t=e.target.value;j(e.target.value),console.log("handleInputChange::ProjectData",p);var r=p.filter((function(e){var r=e.shortId,n=e.name,a=e.description;return n.toLowerCase().includes(t.toLowerCase())||a.toLowerCase().includes(t.toLowerCase())||t.length>0&&parseInt(t)===r}));r&&r.length>0?x(r):x(void 0)},className:"index__search"}),v&&v.length>0?n.createElement(b,{projects:v,setFilteredContents:x}):n.createElement(b,{projects:p,setFilteredContents:x})),void 0!==o&&o.isAdmin?n.createElement("button",{className:"index__button",onClick:g},"Ajouter projet"):""))},P=(0,o.O)((function(){var e=(0,a.useStaticQuery)("758242238"),t=null==e?void 0:e.site.siteMetadata.defaultAssociatedProjectGroupName;return n.createElement(s.a,null,n.createElement(c.Z,null,n.createElement(g,{associatedProjectGroupName:t})))}))},693:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(5861),a=r(7757),c=r.n(a);function o(e,t,r,n){return s.apply(this,arguments)}function s(){return(s=(0,n.Z)(c().mark((function e(t,r,n,a){var o,s,i,u,d,l,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r="get"),o=new Headers,(s={}).method=r,console.log("token :",n),n&&(i="Bearer "+n,o.append("Authorization",i)),a&&(s.body=JSON.stringify(a)),"post"!==r.toLowerCase()&&"patch"!==r.toLowerCase()&&"put"!==r.toLowerCase()||o.append("Content-Type","application/json"),s.headers=o,u="https://myjscourse-api.herokuapp.com/api/"+t,console.log("request made to API at: "+(new Date).toString(),"URL:",u,"Options:",s),e.prev=11,e.next=14,fetch(u,s);case 14:if((d=e.sent).ok){e.next=24;break}return l=" Error code : "+d.status+" : "+d.statusText+"/nMessage : ",e.next=19,d.text();case 19:throw p=e.sent,l+=p,console.error("fetch() error",l),l.search("expired")>-1&&console.log("token expired"),new Error(l);case 24:return e.next=26,d.json();case 26:return e.abrupt("return",e.sent);case 29:throw e.prev=29,e.t0=e.catch(11),console.log("error:",e.t0),e.t0;case 33:case"end":return e.stop()}}),e,null,[[11,29]])})))).apply(this,arguments)}},144:function(e,t,r){r.d(t,{t:function(){return s}});var n=r(5861),a=r(7757),c=r.n(a),o=r(640);function s(e,t){return i.apply(this,arguments)}function i(){return(i=(0,n.Z)(c().mark((function e(t,r){var n,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=16;break}return n={scopes:["openid"],account:t[0]},e.prev=2,e.next=5,r.acquireTokenSilent(n);case 5:return a=e.sent,e.abrupt("return",a.idToken);case 9:if(e.prev=9,e.t0=e.catch(2),!(e.t0 instanceof o.Yo)){e.next=16;break}return e.next=14,r.acquireTokenRedirect(n);case 14:return s=e.sent,e.abrupt("return",s.idToken);case 16:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}},3405:function(e,t,r){r.d(t,{w:function(){return n}});var n=function(e){var t=e.substring(0,e.indexOf("@")),r=t.substring(0,t.indexOf(".")),n=t.substring(t.indexOf(".")+1);return r=r.charAt(0).toUpperCase()+r.slice(1),(n=n.charAt(0).toUpperCase()+n.slice(1)).indexOf(".")>=0&&(n=(n=n.substring(n.indexOf(".")+1)).charAt(0).toUpperCase()+n.slice(1)),r+" "+n}}}]);
//# sourceMappingURL=component---src-pages-project-page-js-3dbdb2bf953104550932.js.map